<!DOCTYPE HTML>
<html lang="es" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Datos - Desarrollo de aplicaciones y servicios</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Ejercicios y prácticas">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/theme.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Desarrollo de aplicaciones y servicios</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/apicai/web-ejercicios-das" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/apicai/web-ejercicios-das/edit/main/src/react-frameworks/navegacion-datos.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="react-frameworks"><a class="header" href="#react-frameworks">React frameworks</a></h1>
<h2 id="navegación"><a class="header" href="#navegación">Navegación</a></h2>
<h3 id="datos"><a class="header" href="#datos">Datos</a></h3>
<p>Es habitual que <strong>los componentes presenten datos provenientes del servidor</strong>. React Router nos facilita cargar esos datos cuando se navegue a dichos componentes.</p>
<p>Para ello, en la configuración de cada ruta y componente se indica la función que carga sus datos, y el componente a cargar en caso de que falle su recuperación:</p>
<pre><code class="language-js">[{
  path: 'una-ruta',
  element: &lt;UnComponente/&gt;,
  errorElement: &lt;ComponenteError/&gt;,
  loader: () =&gt; fetch('/api/un-recurso')
}, ... otras rutas ... ];
</code></pre>
<p>En el componente se recuperan los datos, cargados durante la navegación, utilizando:</p>
<pre><code class="language-js">import {useLoaderData} from "react-router-dom";
...
export default function UnComponente() {
  const datosComponente = useLoaderData();
  ...
}
</code></pre>
<div class="sandpack" data-height="350px" data-width="65" data-navigator="true"><pre data-file="Padre.jsx">
import { Outlet, NavLink, useNavigation } from "react-router-dom";
export default function Padre() {
  const navigation = useNavigation();
  const isLoading = navigation.state === 'loading';
  function getLinkStyle({ isActive, isPending }) {
    return isPending ? "pending" : isActive ? "active" : "";
  }
  return (
    &lt;>
      &lt;header>
        &lt;nav>
          &lt;ul>
            &lt;li>
              &lt;NavLink to='seccion1' 
                className={getLinkStyle}>Sección 1&lt;/NavLink>
            &lt;/li>
            &lt;li>
              &lt;NavLink to='seccion2' 
                className={getLinkStyle}>Sección 2&lt;/NavLink>
            &lt;/li>
          &lt;/ul>
        &lt;/nav>
      &lt;/header>
      &lt;main className={isLoading ? "loading" : ""}>
        &lt;Outlet/>
      &lt;/main>
      &lt;footer>
        {isLoading && &lt;>&lt;span className='spinner'>&lt;/span> Cargando datos ...&lt;/>}
      &lt;/footer>
    &lt;/>
  );
}
</pre><pre data-file="Seccion1.jsx" data-hidden="true">
import { useLoaderData } from "react-router-dom";
export default function Seccion1() {
  const datosComponente = useLoaderData();
  return (
    &lt;article>
      &lt;p>Has mandado {Object.keys(datosComponente.headers).length} cabeceras&lt;/p>
    &lt;/article>
  );
}
</pre><pre data-file="Seccion2.jsx">
import { useLoaderData } from "react-router-dom";
export default function Seccion2() {
  const datosComponente = {};
  return (
    &lt;article>
      &lt;p>Tu IP es {datosComponente.origin}&lt;/p>
    &lt;/article>
  );
}
</pre><pre data-file="Error.jsx">
export default function Error() {
  return (
    &lt;article>
      &lt;h1>⚠️&lt;/h1>
      &lt;p>Error al cargar los datos&lt;/p>
    &lt;/article>
  );
}
</pre><pre data-file="styles.css" data-hidden="true">
@font-face {
  font-family: "Virgil";
  src: url("https://excalidraw.com/Virgil.woff2");
}
body {
  margin: 0;
  font-family: Virgil, Segoe UI Emoji;
}
header {
  background-color: #503C3C;
  color: #fff;
  display: flex;
  padding: 10px 0 10px 0;
}
nav ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  text-align: center;
}
nav a:hover, .active {
  background-color: #A87C7C;
}
nav a {
  color: #fff;
  text-decoration: none;
  padding: 10px;
}
main {
  text-align: center;
}
footer {
  position: fixed;
  left: 0;
  bottom: 0;
  width: 100%;
  border-top: 1px dotted #503C3C;
  padding: 5px;
  height: 0.7rem;
  font-size: 0.7rem;
  color: #503C3C;
}
.pending {
  color: gold;
}
.loading {
  opacity: 0.25;
  transition: opacity 200ms;
  transition-delay: 100ms;
}
.spinner {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24'%3E%3Cpath stroke='black' strokeLinecap='round' strokeLinejoin='round' strokeWidth='2' d='M20 4v5h-.582m0 0a8.001 8.001 0 00-15.356 2m15.356-2H15M4 20v-5h.581m0 0a8.003 8.003 0 0015.357-2M4.581 15H9' /%3E%3C/svg%3E");
  animation: spin 1s infinite linear;
  display: inline-block;
  width: 0.7rem;
  height: 0.7rem;
}
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
</pre><pre data-file="api.js">
export function getHeaders() {
  return fetch('https://httpbin.org/delay/2');
}
export function getIp() {
  return fetch('https://httpbin.org/delay/1');
}
export function getDataWithError() {
  throw new Error('¡Uyyy!');
}
</pre><pre data-file="main.jsx" data-active="true">
import React from "react";
import { createRoot } from "react-dom/client";
import { createBrowserRouter, RouterProvider } from "react-router-dom";
import { getHeaders, getIp, getDataWithError } from "./api.js";
import Padre from "./Padre";
import Seccion1 from "./Seccion1";
import Seccion2 from "./Seccion2";
import Error from "./Error";
import "./styles.css";
// Configuración de rutas y componentes
const router = createBrowserRouter([{
  path: "/",
  element: &lt;Padre/>,
  children: [{
    path: "seccion1",
    element: &lt;Seccion1/>,
    errorElement: &lt;Error/>,
    loader: () => getHeaders()
  },{
    path: "seccion2",
    element: &lt;Seccion2/>,
    errorElement: &lt;Error/>
  }],
}]);
createRoot(document.getElementById("root")).render(
  &lt;React.StrictMode>
    &lt;RouterProvider router={router} />
  &lt;/React.StrictMode>
);
</pre><pre data-file="package.json" data-hidden="true">
{
  "dependencies": {
    "react": "^18.0.0",
    "react-dom": "^18.0.0",
    "react-scripts": "^5.0.0",
    "react-router-dom": "^6.21.2"
  },
  "main": "/main.jsx",
  "devDependencies": {}
}
</pre></div>
<blockquote>
<p><strong>❓ Ejercicio 3:</strong> <em>Estudia el código anterior y comprende cómo se ha configurado la carga de los datos de la "Sección 1". Completa el código para que en la "Sección 2" se carguen los datos que devuelve el API <code>getIp()</code>. Luego, utiliza <code>getDataWithError()</code> en su lugar y describe el comportamiento.</em></p>
</blockquote>
<blockquote>
<p><strong>❓ Ejercicio 4:</strong> <em>Identifica en <code>Padre.jsx</code> el código que detecta que se están cargando datos para modificar la presentación e indicarlo al usuario. Indica también qué elementos cambian su presentación.</em></p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../react-frameworks/navegacion.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../react-frameworks/navegacion-acciones.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../react-frameworks/navegacion.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../react-frameworks/navegacion-acciones.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/theme.js"></script>


    </div>
    </body>
</html>
